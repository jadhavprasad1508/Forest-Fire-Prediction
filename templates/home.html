<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Fire Weather Index Predictor</title>

    <!-- Typography -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">

    <style>
        /* =========================
           Color Palette & Typography
           ========================= */
        :root{
            --bg-100: #f4f6f8;            /* page background (soft neutral) */
            --card: #ffffff;              /* card background */
            --muted: #6b7280;             /* muted text */
            --primary: #b03a2e;           /* warm primary (fire) */
            --primary-600: #923026;
            --accent: #ffb86b;            /* warm accent */
            --ink: #102a43;               /* main text (deep) */
            --success: #2f855a;           /* result/good */
            --glass: rgba(255,255,255,0.6);
            --radius-lg: 16px;
            --radius-md: 10px;
            --shadow-lg: 0 20px 50px rgba(16,42,67,0.12);
            --shadow-sm: 0 6px 18px rgba(16,42,67,0.06);
            --focus-ring: 0 0 0 6px rgba(176,58,46,0.08);
        }

        *{box-sizing:border-box}
        html,body{height:100%}
        body{
            margin:0;
            font-family:"Inter",system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial;
            background:
              radial-gradient(1200px 600px at 10% 10%, rgba(176,58,46,0.04), transparent 6%),
              linear-gradient(180deg, var(--bg-100), #e7eaee 60%);
            color:var(--ink);
            -webkit-font-smoothing:antialiased;
            -moz-osx-font-smoothing:grayscale;
            padding:32px;
            display:flex;
            align-items:center;
            justify-content:center;
        }

        /* =========================
           Page Container & Layout
           ========================= */
        .page {
            width:100%;
            max-width:1100px;
            display:grid;
            grid-template-columns: 1fr 420px;
            gap:28px;
            align-items:start;
        }

        /* card */
        .card {
            background: linear-gradient(180deg, rgba(255,255,255,0.65), var(--card));
            border-radius:var(--radius-lg);
            padding:28px;
            box-shadow:var(--shadow-lg);
            border:1px solid rgba(16,42,67,0.03);
        }

        /* left panel (hero + explanation + form) */
        .hero {
            padding:26px;
            display:flex;
            flex-direction:column;
            gap:18px;
        }

        .brand {
            display:flex;
            gap:12px;
            align-items:center;
        }
        .logo {
            width:56px;
            height:56px;
            flex:0 0 56px;
            border-radius:12px;
            display:grid;
            place-items:center;
            background: linear-gradient(135deg, rgba(176,58,46,0.12), rgba(255,184,107,0.08));
            box-shadow:var(--shadow-sm);
            border:1px solid rgba(176,58,46,0.06);
        }
        .logo svg{width:34px;height:34px}

        h1{
            margin:0;
            font-size:1.6rem;
            line-height:1.1;
            letter-spacing:-0.01em;
            color:var(--ink);
        }
        p.lead {
            margin:0;
            color:var(--muted);
            font-size:0.95rem;
            max-width:66ch;
        }

        /* layout of form area */
        .form-wrap {
            margin-top:6px;
        }

        form {
            display:grid;
            grid-template-columns: repeat(3, 1fr);
            gap:16px;
            margin-top:14px;
        }

        .field {
            display:flex;
            flex-direction:column;
            gap:8px;
        }
        label{
            font-size:0.85rem;
            color:var(--muted);
            font-weight:600;
        }

        input[type="number"], select {
            padding:12px 14px;
            border-radius:var(--radius-md);
            border:1px solid rgba(16,42,67,0.06);
            background:linear-gradient(180deg, rgba(255,255,255,0.6), rgba(245,247,249,0.9));
            font-size:0.98rem;
            color:var(--ink);
            transition:box-shadow .18s ease, transform .08s ease, border-color .12s;
            outline:none;
        }
        input::-webkit-outer-spin-button,
        input::-webkit-inner-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }
        input:focus, select:focus {
            box-shadow: var(--focus-ring);
            border-color:var(--primary);
            transform:translateY(-1px);
        }

        .full { grid-column: 1 / -1; }
        .span-2 { grid-column: span 2; }

        .actions {
            display:flex;
            align-items:center;
            gap:12px;
            margin-top:6px;
            grid-column: 1 / -1;
        }

        .btn {
            background: linear-gradient(180deg,var(--primary),var(--primary-600));
            color:white;
            padding:12px 18px;
            border-radius:12px;
            font-weight:700;
            border:none;
            cursor:pointer;
            box-shadow:0 8px 26px rgba(176,58,46,0.18);
            transition: transform .12s ease, box-shadow .12s ease;
            display:inline-flex;
            gap:10px;
            align-items:center;
        }
        .btn:active{ transform: translateY(1px) }
        .btn[disabled]{ opacity:.6; cursor:not-allowed; transform:none; box-shadow:none }

        .ghost {
            background:transparent;
            color:var(--primary);
            border:1px solid rgba(176,58,46,0.12);
            padding:10px 14px;
            border-radius:10px;
            font-weight:600;
        }

        /* Right panel: visual and result */
        .aside {
            display:flex;
            flex-direction:column;
            gap:18px;
            position:relative;
        }

        .visual {
            border-radius:12px;
            overflow:hidden;
            min-height:220px;
            display:grid;
            grid-template-rows: 1fr;
            position:relative;
            background: linear-gradient(180deg, rgba(176,58,46,0.05), rgba(255,184,107,0.02));
            border:1px solid rgba(16,42,67,0.03);
            padding:14px;
        }

        /* simple SVG-based illustration block */
        .visual .illu {
            display:flex;
            align-items:center;
            justify-content:center;
            height:100%;
            width:100%;
        }

        /* result card */
        .result {
            background: linear-gradient(180deg,#ffffff, #fbfffb);
            border-radius:12px;
            padding:16px;
            box-shadow:var(--shadow-sm);
            border:1px solid rgba(47,133,90,0.08);
        }
        .result h3 {
            margin:0 0 8px 0;
            font-size:1.05rem;
        }
        .result .value {
            font-size:1.6rem;
            font-weight:700;
            color:var(--success);
            letter-spacing:0.01em;
        }
        .result.error {
            border-color: rgba(176,58,46,0.12);
            background: linear-gradient(180deg,#fffaf9,#fff6f6);
        }
        .meta {
            font-size:0.85rem;
            color:var(--muted);
            margin-top:8px;
        }

        /* small tip row */
        .tips {
            margin-top:8px;
            font-size:0.9rem;
            color:var(--muted);
            display:flex;
            gap:8px;
            flex-wrap:wrap;
        }

        .chip {
            background:rgba(16,42,67,0.04);
            padding:6px 8px;
            border-radius:999px;
            font-weight:600;
            font-size:0.78rem;
            color:var(--muted);
        }

        /* subtle animated reveal for result container when server renders */
        .result-animate {
            opacity:0;
            transform: translateY(10px) scale(0.995);
            animation: reveal .6s cubic-bezier(.2,.9,.2,1) forwards;
        }
        @keyframes reveal {
            to { opacity:1; transform:none; }
        }

        /* Footer */
        .foot {
            margin-top:14px;
            font-size:0.82rem;
            color:var(--muted);
            text-align:center;
        }

        /* Responsive adjustments */
        @media (max-width:1040px){
            .page { grid-template-columns: 1fr; padding:0 6px; }
            .aside { order:2 }
            .hero { order:1 }
            .visual { min-height:180px }
        }

        @media (max-width:680px){
            form { grid-template-columns: 1fr; }
            .full { grid-column: auto }
            .span-2 { grid-column:auto }
            .logo{ width:48px;height:48px }
            h1{ font-size:1.3rem }
        }

        /* Accessibility: focus-visible */
        :focus-visible { outline: 3px solid rgba(16,42,67,0.06); outline-offset: 2px; border-radius:6px; }

        /* small spinner for button */
        .spinner {
            width:18px;
            height:18px;
            border-radius:50%;
            border:2px solid rgba(255,255,255,0.18);
            border-top-color:rgba(255,255,255,0.92);
            animation:spin .9s linear infinite;
        }
        @keyframes spin { to { transform:rotate(360deg) } }
    </style>
</head>
<body>
    <main class="page" role="main" aria-labelledby="pageTitle">
        <!-- LEFT: form, title, explanation -->
        <section class="card hero" aria-labelledby="pageTitle">
            <div class="brand" aria-hidden="false">
                <div class="logo" aria-hidden="true">
                    <!-- compact inline SVG logo: flame + leaf -->
                    <svg viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg" role="img" aria-label="logo">
                        <defs>
                            <linearGradient id="g1" x1="0" x2="1" y1="0" y2="1">
                                <stop offset="0" stop-color="#ffb86b"/>
                                <stop offset="1" stop-color="#b03a2e"/>
                            </linearGradient>
                            <linearGradient id="g2" x1="0" x2="1">
                                <stop offset="0" stop-color="#2f855a" />
                                <stop offset="1" stop-color="#1f6f4b" />
                            </linearGradient>
                        </defs>
                        <path d="M24 4c0 8-6 10-6 16 0 6 6 6 6 14 6-6 10-9 10-20C34 8 24 4 24 4z" fill="url(#g1)"/>
                        <path d="M12 36c6-10 18-8 22-4-6 6-12 10-22 12v-8z" fill="url(#g2)" opacity="0.95"/>
                    </svg>
                </div>
                <div>
                    <div style="font-weight:700;color:var(--ink);font-size:0.95rem">Fire Weather Index Predictor</div>
                    <div style="font-size:0.78rem;color:var(--muted)">Data-driven early warning for fire risk</div>
                </div>
            </div>

            <h1 id="pageTitle">ðŸ”¥ Fire Weather Index Predictor</h1>
            <p class="lead">Enter local environmental and fuel-code values to estimate the Fire Weather Index (FWI). This tool is designed for quick, reliable predictions to support decision-making and early warnings.</p>

            <div class="form-wrap card" style="padding:16px; margin-top:6px;">
                <form id="predictionForm" action="/predict" method="POST" novalidate>
                    <!-- Row-first -->
                    <div class="field">
                        <label for="temperature">Temperature (Â°C)</label>
                        <input type="number" step="0.1" id="temperature" name="temperature" placeholder="e.g. 29" required aria-required="true">
                    </div>

                    <div class="field">
                        <label for="rh">Relative Humidity (%)</label>
                        <input type="number" step="0.1" id="rh" name="rh" placeholder="e.g. 57" required>
                    </div>

                    <div class="field">
                        <label for="ws">Wind Speed (km/h)</label>
                        <input type="number" step="0.1" id="ws" name="ws" placeholder="e.g. 18" required>
                    </div>

                    <div class="field">
                        <label for="rain">Rain (mm)</label>
                        <input type="number" step="0.1" id="rain" name="rain" placeholder="e.g. 0" required>
                    </div>

                    <div class="field">
                        <label for="ffmc">Fine Fuel Moisture Code (FFMC)</label>
                        <input type="number" step="0.1" id="ffmc" name="ffmc" placeholder="e.g. 65.7" required>
                    </div>

                    <div class="field">
                        <label for="dmc">Drought Moisture Code (DMC)</label>
                        <input type="number" step="0.1" id="dmc" name="dmc" placeholder="e.g. 3.4" required>
                    </div>

                    <div class="field">
                        <label for="isi">Initial Spread Index (ISI)</label>
                        <input type="number" step="0.1" id="isi" name="isi" placeholder="e.g. 1.3" required>
                    </div>

                    <div class="field">
                        <label for="classes">Classes</label>
                        <select id="classes" name="classes" required>
                            <option value="" disabled selected>Select Class</option>
                            <option value="0">Not Fire</option>
                            <option value="1">Fire</option>
                        </select>
                    </div>

                    <div class="field">
                        <label for="region">Region</label>
                        <select id="region" name="region" required>
                            <option value="" disabled selected>Select Region</option>
                            <option value="0">Bejaia Region</option>
                            <option value="1">Sidi Bel-abbes Region</option>
                        </select>
                    </div>

                    <div class="actions">
                        <button type="submit" class="btn" id="submitBtn" aria-label="Predict FWI">
                            <span id="btnLabel">PREDICT FWI</span>
                            <span id="btnSpinner" style="display:none;margin-left:6px" aria-hidden="true" title="working">
                                <span class="spinner" aria-hidden="true"></span>
                            </span>
                        </button>

                        <button type="button" class="ghost" id="resetBtn">Reset</button>

                        <div style="margin-left:auto" class="tips" aria-hidden="true">
                            <span class="chip">Quick</span>
                            <span class="chip">Mobile-friendly</span>
                            <span class="chip">Accessible</span>
                        </div>
                    </div>
                </form>
            </div>

            <div class="foot">Tip: Use precise decimal inputs (e.g., 0.1 steps) for best predictive accuracy.</div>
        </section>

        <!-- RIGHT: illustration + result area -->
        <aside class="aside">
            <div class="card visual" aria-hidden="false" title="Contextual illustration">
                <div class="illu" role="img" aria-label="Illustration of fire weather concept">
                    <!-- Decorative SVG illustration: map + weather icons -->
                    <svg width="100%" height="100%" viewBox="0 0 540 300" preserveAspectRatio="xMidYMid meet" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
                        <defs>
                            <linearGradient id="sky" x1="0" x2="1"><stop offset="0" stop-color="#f9fafb"/><stop offset="1" stop-color="#fff4ed"/></linearGradient>
                        </defs>
                        <rect width="100%" height="100%" fill="url(#sky)"/>
                        <!-- stylized hills -->
                        <path d="M0,220 C120,160 180,240 300,220 C420,200 480,260 540,220 L540,300 L0,300 Z" fill="#e9f6f0" opacity="0.9"/>
                        <!-- sun -->
                        <circle cx="460" cy="60" r="34" fill="#ffb86b" opacity="0.95"/>
                        <!-- flame icon -->
                        <g transform="translate(60,70) scale(1.15)">
                            <path d="M48 8s-12 8-12 18c0 14 12 14 12 28 12-12 20-18 20-36C68 18 48 8 48 8z" fill="#b03a2e"/>
                            <path d="M40 24c0 8 10 8 10 18 6-6 8-10 8-18 0-8-10-12-18-12S40 16 40 24z" fill="#ffb86b"/>
                        </g>
                    </svg>
                </div>
            </div>

            <!-- Result area: keeps your templating and server-rendered logic -->
            <div class="result {% if error %}error{% endif %} {% if prediction_result or error %}result-animate{% endif %}" id="resultDisplay"
                 style="display: {{ 'block' if prediction_result or error else 'none' }};" role="status" aria-live="polite">

                {% if prediction_result %}
                    <h3>FWI Prediction</h3>
                    <div class="value">{{ "%.2f" | format(prediction_result | float) }}</div>
                    <div class="meta">Lower values indicate lower fire risk; use this as one input among others for operational decisions.</div>
                {% endif %}

                {% if error %}
                    <h3 style="color:var(--primary)">Error</h3>
                    <div class="value" style="color:var(--primary)">{{ error }}</div>
                    <div class="meta">Check inputs and try again. If the issue persists, verify server logs.</div>
                {% endif %}
            </div>

            <div style="font-size:0.8rem;color:var(--muted);text-align:center;padding-top:2px">Model: FWI estimator â€¢ Inputs preserved</div>
        </aside>
    </main>

    <!-- ================================
         Lightweight Interactivity (JS)
         - Prevent double submit, show spinner, reset form, client-side validation hints
         ================================= -->
    <script>
        (function(){
            const form = document.getElementById('predictionForm');
            const submitBtn = document.getElementById('submitBtn');
            const btnLabel = document.getElementById('btnLabel');
            const btnSpinner = document.getElementById('btnSpinner');
            const resetBtn = document.getElementById('resetBtn');

            // show spinner and disable to avoid double submits
            form.addEventListener('submit', function(e){
                // basic constraint check: let browser handle invalid inputs
                if (!form.reportValidity()) {
                    return; // let browser show errors
                }
                // show micro-feedback
                submitBtn.setAttribute('disabled', 'true');
                btnLabel.textContent = 'PREDICTING...';
                btnSpinner.style.display = 'inline-block';
                // allow normal POST to occur; disabling prevents double-submits
            });

            resetBtn.addEventListener('click', function(){
                // reset fields but preserve selection if needed
                form.reset();
                // re-enable submit
                submitBtn.removeAttribute('disabled');
                btnLabel.textContent = 'PREDICT FWI';
                btnSpinner.style.display = 'none';
                // focus first input for quick re-entry
                const first = form.querySelector('input, select, textarea');
                if(first) first.focus();
            });

            // tiny UX: show validation hint on invalid input
            const inputs = form.querySelectorAll('input, select');
            inputs.forEach(i => {
                i.addEventListener('invalid', (ev) => {
                    ev.target.classList.add('invalid');
                    // an unobtrusive brief highlight
                    setTimeout(()=>ev.target.classList.remove('invalid'), 800);
                });
            });

            // If server has returned a result, focus result area for screen readers
            window.addEventListener('load', function(){
                const result = document.getElementById('resultDisplay');
                if (result && window.getComputedStyle(result).display !== 'none') {
                    result.setAttribute('tabindex','-1');
                    result.focus({preventScroll:true});
                }
            });
        })();
    </script>
</body>
</html>
